/* Populate database with sample data. */

INSERT INTO ANIMALS (NAME,DATE_OF_BIRTH,WEIGHT_KG,NEUTERED,ESCAPE_ATTEMPTS) 
 VALUES ('Agumon','02-03-2020',10.23,true,2),
 ('Gabumon','11-15-2018',8,true,2),
 ('Pikachu','01-07-2021',15.04,false,1),
 ('Devimon','05-12-2021',11,true,5);


-- Day 2
INSERT INTO ANIMALS (NAME,DATE_OF_BIRTH,WEIGHT_KG,NEUTERED,ESCAPE_ATTEMPTS)
 VALUES ('Charmander','02-08-2020',-11,false,0),
 ('Plantmon','11-15-2021',-5.7,true,2),
 ('Squirtle','04-02-1993',-12.13,false,3),
 ('Angemon','06-12-2005',-45,true,1),('Boarmon','06-07-2005',20.4,true,7),
 ('Blossom','10-13-1998',17,true,3),('Ditto','05-14-2022',22,true,4);


BEGIN TRANSACTION;
UPDATE ANIMALS 
SET SPECIES = 'unspecified';
SELECT species from animals;
ROLLBACK ;
SELECT species from animals;


BEGIN TRANSACTION; 
UPDATE ANIMALS SET SPECIES = 'digimon' WHERE NAME LIKE '%mon';
UPDATE ANIMALS SET SPECIES = 'pokemon' WHERE SPECIES IS NULL;
COMMIT TRANSACTION ;
SELECT species from animals;


BEGIN TRANSACTION ;
DELETE FROM ANIMALS;
ROLLBACK ;
SELECT COUNT(*) FROM ANIMALS;


BEGIN TRANSACTION ;
DELETE FROM ANIMALS WHERE DATE_OF_BIRTH > '01-01-2022';
SAVEPOINT MV1;
UPDATE ANIMALS SET WEIGHT_KG = WEIGHT_KG * -1 ;
ROLLBACK TO MV1;
UPDATE ANIMALS SET WEIGHT_KG = WEIGHT_KG * -1 WHERE WEIGHT_KG < 0;
COMMIT TRANSACTION ;
SELECT * from animals;


-- Day 3

INSERT INTO OWNERS (FULL_NAME,AGE) VALUES 
('Sam Smith',34),
('Jennifer Orwell',19),('Bob',45),
('Melody Pond',77),('Dean Winchester',14),
('Jodie Whittaker',38);

INSERT INTO SPECIES (NAME) VALUES
('Pokemon'),
('Digimon');

BEGIN TRANSACTION ;
UPDATE ANIMALS SET SPECIES_ID = 2 WHERE NAME LIKE '%mon';
UPDATE ANIMALS SET SPECIES_ID = 1 WHERE SPECIES_ID IS NULL;
COMMIT TRANSACTION ;
SELECT * FROM ANIMALS;

BEGIN TRANSACTION ;
UPDATE ANIMALS SET OWNER_ID = 1 WHERE NAME = 'Agumon';
UPDATE ANIMALS SET OWNER_ID = 2 WHERE NAME = 'Gabumon';
UPDATE ANIMALS SET OWNER_ID = 2 WHERE NAME = 'Pikachu';
UPDATE ANIMALS SET OWNER_ID = 3 WHERE NAME = 'Devimon';
UPDATE ANIMALS SET OWNER_ID = 3 WHERE NAME = 'Plantmon';
UPDATE ANIMALS SET OWNER_ID = 4 WHERE NAME = 'Charmander';
UPDATE ANIMALS SET OWNER_ID = 4 WHERE NAME = 'Squirtle';
UPDATE ANIMALS SET OWNER_ID = 4 WHERE NAME = 'Blossom';
UPDATE ANIMALS SET OWNER_ID = 5 WHERE NAME = 'Angemon';
UPDATE ANIMALS SET OWNER_ID = 5 WHERE NAME = 'Boarmon';
COMMIT TRANSACTION ;
SELECT * FROM ANIMALS;




-- Day 4

INSERT INTO VETS (NAME,AGE,DATE_OF_GRADUATION) VALUES 
('Vet William Tatcher',45,'04-23-2000'),
('Vet Maisy Smith', 26,'01-17-2019'),
('Vet Stephanie Mendez',64,'05-04-1981'),
('Vet Jack Harkness',38,'06-08-2008');

INSERT INTO SPECIALIZATIONS (VET_ID,SPECIES_ID) VALUES (1,1) , (3,1),(3,2),(4,2);

INSERT INTO VISITS (ANIMAL_ID,VET_ID,DATE_OF_VISIT) 
VALUES (1,1,'05-24-2020'),
(1,3,'07-22-2020'),
(1,4,'02-02-2021'),
(3,2,'01-05-2020'),
(3,2,'03-08-2020'),(3,2,'05-14-2020'),
(4,3,'05-04-2021'),(5,4,'02-24-2021'),
(6,2,'12-21-2019'),(6,1,'08-10-2020'),
(6,2,'04-07-2021'),(7,3,'09-29-2019'),
(8,4,'10-03-2020'),(8,4,'11-04-2020'),
(9,2,'01-24-2019'),(9,2,'05-15-2019'),
(9,2,'02-27-2020'),(9,2,'08-03-2020'),
(10,3,'05-24-2020'),(10,1,'01-11-2021');


-- WEEK 2 DAY 1

-- (MV DATA RAN 8 TIMES TO GET EXECUTIO TIME >= 1000)
INSERT INTO visits (animal_id, vet_id, date_of_visit) SELECT * FROM (SELECT id FROM animals) animal_ids, (SELECT id FROM vets) vets_ids, generate_series('1980-01-01'::timestamp, '2021-01-01', '4 hours') visit_timestamp;
insert into owners (full_name, email) select 'Owner ' || generate_series(1,2500000), 'owner_' || generate_series(1,2500000) || '@mail.com';
-- (MV DATA)
